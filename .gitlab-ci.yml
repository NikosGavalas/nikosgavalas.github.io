variables:
  LC_ALL: "C.UTF-8"
  LANG: "en_US.UTF-8"
  LANGUAGE: "en_US.UTF-8"

build:
  image: jekyll-arm
  stage: build
  script:
    - cd blog-jekyll
    - bundle install
    - bundle exec jekyll build
  artifacts:
    name: blog
    paths:
      - blog-jekyll/_site/
    expire_in: 1 week

deploy:
  # https://git.gmantaos.com/docker/ssh-client-arm
  image: gmantaos/ssh-client-arm
  stage: deploy
  dependencies:
    - build
  only:
    - master
  script:
    - apk add tree
    - tree
    - eval $(ssh-agent -s)
    - echo "$SSH_PRIVATE_KEY" | tr -d '\r' | ssh-add - > /dev/null
    # ssh-keyscan <host>
    - echo "$SSH_KNOWN_HOSTS" > ~/.ssh/known_hosts

